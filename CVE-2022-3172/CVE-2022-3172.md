# CVE-2022-3172

## Experiment Environment

linux/amd64

kind  v0.14.0

kubectl  v1.24.4

kubernetes  v1.24.0

## Description

​	A security issue was discovered in kube-apiserver that allows an aggregated API server to redirect client traffic to any URL. This could lead to the client performing unexpected actions as well as forwarding the client's API server credentials to third parties.

kube-apiserver允许聚合API server去重定向客户端流量到任何URL

导致客户端的证书泄露

SSRF攻击

APIService对象的创建可以将流量定向到任何聚合API

## Pocs

```
cd samlpe-apiserver
```

按照说明部署aggregated-apiserver即可

```
kubectl get --raw="/apis/wardle.example.com/v1alpha1/flunders"
```

可以发现被重定向到baidu.com